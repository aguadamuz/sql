--by total signature count
SELECT name, tag_id, 'http://www.change.org/p/' || id AS petition_url, photo_id
FROM(
SELECT t.name, t.id AS tag_id, e.total_signature_count, e.id, e.photo_id, ROW_NUMBER () OVER (PARTITION BY t.name ORDER BY e.total_signature_count DESC) AS row_num
FROM events e JOIN taggings tgs ON e.id = tgs.taggable_id JOIN tags t ON t.id = tgs.tag_id
WHERE t.id IN
(
7560,
7367,
7621,
7426,
7779,
7579,
7437,
7482,
7078,
4131,
7645,
23396,
7442,
7849,
9214,
7577,
8813,
4527,
7893,
2316,
6593,
7799,
7514,
25298,
7291,
3,
7581,
6584,
7331,
8534,
2330,
7780,
8101,
4636,
7635,
7750,
2604,
7778,
8646,
101,
672,
7733,
7578,
7728,
4570,
6583,
7359,
4717,
7368,
9004,
7623,
7785,
6494,
7376,
7682,
9102,
7664,
2402,
7565,
8525,
7795,
4382,
2313,
2916,
8817,
7681,
4111,
2473,
2561,
8017,
7836,
25294,
23452,
4435,
21341,
3302,
3507,
7734,
23432,
7903,
8216,
2361,
7636,
7983,
8839,
2417,
8004,
23408,
2571,
2641,
7812,
6589,
7798,
23456,
17135,
4919,
2536,
4109,
7731,
5182)
ORDER BY 1
)
WHERE row_num = 1
LIMIT 101;

SELECT name, tag_id, victory_date, 'http://www.change.org/p/' || id AS petition_url, photo_id
FROM(
SELECT t.name, t.id AS tag_id, e.victory_date, e.id, e.photo_id, ROW_NUMBER () OVER (PARTITION BY t.name ORDER BY e.victory_date DESC) AS row_num
FROM events e JOIN taggings tgs ON e.id = tgs.taggable_id JOIN tags t ON t.id = tgs.tag_id
WHERE t.id IN
(
7560,
7367,
7621,
7426,
7779,
7579,
7437,
7482,
7078,
4131,
7645,
23396,
7442,
7849,
9214,
7577,
8813,
4527,
7893,
2316,
6593,
7799,
7514,
25298,
7291,
3,
7581,
6584,
7331,
8534,
2330,
7780,
8101,
4636,
7635,
7750,
2604,
7778,
8646,
101,
672,
7733,
7578,
7728,
4570,
6583,
7359,
4717,
7368,
9004,
7623,
7785,
6494,
7376,
7682,
9102,
7664,
2402,
7565,
8525,
7795,
4382,
2313,
2916,
8817,
7681,
4111,
2473,
2561,
8017,
7836,
25294,
23452,
4435,
21341,
3302,
3507,
7734,
23432,
7903,
8216,
2361,
7636,
7983,
8839,
2417,
8004,
23408,
2571,
2641,
7812,
6589,
7798,
23456,
17135,
4919,
2536,
4109,
7731,
5182)
AND e.victory_date IS NOT NULL
)
WHERE row_num = 1
LIMIT 101